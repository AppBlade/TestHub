<%= sign_contents do %>
  <% CFPropertyList.xml_parser_interface.new.to_str(:root => CFPropertyList.guess({
    PayloadContent: [{
      PayloadContent: {
        Challenge: [@device.id, @device.secret].join(':'),
        Keysize: 1024,
        Subject: [
          [['CN', t('devices.scep.cn')]]
        ],
        URL: scep_url
      },
      PayloadVersion: 1,
      PayloadUUID: SecureRandom.uuid,
      PayloadIdentifier: 'com.testhub.registration.phase-3.scep',
      PayloadType: 'com.apple.security.scep'
    }],
    PayloadDisplayName: t('devices.new.display_name'),
    PayloadOrganization: t('devices.new.organization'),
    PayloadVersion: 1,
    PayloadUUID: SecureRandom.uuid,
    PayloadIdentifier: 'com.testhub.registration.phase-3',
    PayloadType: 'Configuration'
  })).html_safe -%>
<% end -%>
